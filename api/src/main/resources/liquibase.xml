<?xml version="1.0" encoding="UTF-8"?>
 
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9
                  http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd">

    <changeSet id="create-appointment_speciality_table-201706291130" author="Shruthi,Pushpa">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="appointment_speciality" />
            </not>
        </preConditions>

        <sql>
            CREATE  TABLE IF NOT EXISTS appointment_speciality (
            speciality_id INT NOT NULL AUTO_INCREMENT ,
            name VARCHAR(50) NOT NULL ,
            date_created DATETIME NOT NULL ,
            creator INT NOT NULL ,
            date_changed DATETIME NULL ,
            changed_by INT NULL ,
            uuid  VARCHAR(38) NOT NULL UNIQUE,
            voided TINYINT NULL ,
            PRIMARY KEY (speciality_id) ,
            UNIQUE INDEX name_UNIQUE (name ASC) )

        </sql>
    </changeSet>

    <changeSet id="create-appointment_service_table-201706291130" author="Shruthi,Pushpa">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="appointment_service" />
            </not>
        </preConditions>

        <sql>
            CREATE  TABLE IF NOT EXISTS appointment_service (
            appointment_service_id INT NOT NULL AUTO_INCREMENT ,
            name VARCHAR(50) NOT NULL ,
            description TEXT NULL,
            start_time TIME NULL ,
            end_time TIME NULL ,
            location_id INT NULL ,
            speciality_id INT NULL ,
            max_appointments_limit INT NULL ,
            duration_mins INT NULL ,
            date_created DATETIME NOT NULL ,
            creator INT NOT NULL ,
            date_changed DATETIME NULL ,
            changed_by INT NULL ,
            voided TINYINT NULL ,
            uuid  VARCHAR(38) NOT NULL UNIQUE,
            PRIMARY KEY (appointment_service_id) ,
            INDEX fk_appointment_service_speciality_idx (speciality_id ASC) ,
            INDEX fk_appointment_service_location_idx (location_id ASC) ,
            UNIQUE INDEX name_UNIQUE (name ASC) ,
            CONSTRAINT fk_appointment_service_speciality
            FOREIGN KEY (speciality_id )
            REFERENCES appointment_speciality (speciality_id )
            ON DELETE NO ACTION
            ON UPDATE NO ACTION,
            CONSTRAINT fk_appointment_service_location
            FOREIGN KEY (location_id )
            REFERENCES location (location_id ))
        </sql>
    </changeSet>
</databaseChangeLog>